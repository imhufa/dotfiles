import{p as w,a as U,b as F}from"./968c44ae597c16c4e4a5c278f0b71435.js";import{A as b,_ as k}from"./868e2f778520f2da472700481dad9c46.js";import{H as _,A as y}from"./e412787c9b354f52d337c0d89a7a2afb.js";import{d as C,G as I,bx as x,bC as d,aT as g,aI as p,J as a,b5 as c,W as P,au as E,I as m,H as h}from"./b25f058dd0413b28b0729fd121febeca.js";import"./bad6fc33885c3dcbb1ba56439c60597f.js";import"./5014d19e01b2dbb684595ee83e3544cc.js";import"./f6c2ea3b0cc179a4b83702356ba845d1.js";import"./037131c481fa585d02e4fbfce6b00d30.js";import"./8927cb3a31b28f8a8f7a0cb0bcd7a270.js";import"./ef6e94b174353d77df2f6d030dd5f4e9.js";import"./996869ba6d63f2f6359689debd17c6d1.js";import"./6d607360b71772a2db5fecf7e66b72f4.js";w.GlobalWorkerOptions.workerSrc=U;const A=async a=>await new Promise(((e,t)=>{const i=new FileReader;i.onload=async a=>{var i;if(null!=(i=a.target)&&i.result)try{const t=await F.getDocument({data:a.target.result}).promise;let i="";for(let a=1;a<=t.numPages;a++)try{const e=undefined;i+=(await(await t.getPage(a)).getTextContent()).items.map((a=>a.str)).join(" ")}catch(r){console.log(`Error occurred while reading page ${a}: ${r}`);continue}t.destroy(),e(i)}catch(o){t(`Error occurred while reading PDF file: ${o}`)}else t("No result found")},i.onerror=()=>{t(`Error occurred while reading file: ${i.error}`)},i.readAsArrayBuffer(a)})),M=C({extends:b,name:"PdfUploader",data:()=>({pdfUploadErrorMessage:"",pdfUploadPromptId:"",pdfUploadIsProcessing:!1,pdfUploadDragActive:!1}),methods:{async uploadPDF(a){const e=a.target.files[0];await this.processFile(e)},dragOver(a){a.preventDefault(),this.pdfUploadDragActive=!0},dragEnter(a){a.preventDefault(),this.pdfUploadDragActive=!0},dragLeave(a){a.preventDefault(),this.pdfUploadDragActive=!1},async handleDrop(a){const e=a.dataTransfer.files[0];await this.processFile(e)},async processFile(a){if(a&&"application/pdf"===a.type&&a.name.toLowerCase().endsWith(".pdf")){this.pdfUploadErrorMessage="",this.pdfUploadIsProcessing=!0;try{const e=await A(a);if(""===e)return this.pdfUploadErrorMessage=this.__("Content of the file is empty. Please upload a regular PDF file. Photo converted PDF files cannot be used at ChatPDF"),void(this.pdfUploadIsProcessing=!1);this.changeStorage("settings.web_access",!1,!1),this.pdfUploadPromptId=_.SHA1(this.getFileName(a));const t="",i=a.name;this.newChat(),this.closeModel(),this.changeStorage("settings.ai_model","GPT-3.5"),y.chat(e,"GPT-3.5","ai_chat","__all",!0,!1,i,!1,{is_pdf:!0,prompt_prefix:y.prompt_prefix,language_name:this.settings.language_name}),null!=document.querySelector("#fileInputPDF")&&(document.querySelector("#fileInputPDF").value=null)}catch(e){console.log(e),this.pdfUploadErrorMessage=this.__("Something went wrong. Please try again.")}finally{this.pdfUploadIsProcessing=!1}}else this.pdfUploadErrorMessage=this.__("Please upload a valid PDF file.")},getFileName:a=>_.slugify(a.name),closeModel(){let a=document.querySelector('[data-ait-dropdown-toggle="ait-pdf-upload-modal"]');a&&(this.pdfUploadPromptId="",a.click()),a=document.querySelector("#ait-pdf-upload-modal button[data-modal-hide]"),a&&(this.pdfUploadPromptId="",a.click())}}}),S={class:"ait-p-4 ait-w-full ait-text-center ait-flex ait-flex-col ait-items-center ait-gap-3"},N={class:"ait-px-4 ait-text-sm ait-text-neutral-600 dark:ait-text-neutral-400"},$=["disabled"],T={for:"fileInputPDF",class:"ait-w-full ait-h-full ait-relative ait-z-[9999]"},B={class:"ait-flex ait-flex-col ait-w-full ait-p-6 ait-items-center ait-justify-center ait-mt-4 ait-border-2 ait-border-dotted ait-border-neutral-300 dark:ait-border-neutral-700 ait-rounded-lg ait-text-neutral-600 dark:ait-text-neutral-400 ait-text-center ait-cursor-pointer ait-transition-all hover:ait-opacity-70"},q={class:"ait-flex ait-flex-col ait-items-center ait-gap-1 ait-mt-2"},G={class:"ait-block ait-text-xs"},H={key:0,class:"ait-flex ait-justify-center ait-items-center ait-h-25"},L=a("div",{class:"ait-border-4 ait-border-solid ait-border-t-transparent ait-border-gray-200 ait-rounded-full ait-w-9 ait-h-9 ait-animate-spin"},null,-1),O=[L],V={class:"ait-h-6"},W={key:0,class:"ait-text-red-500 ai-text-sm"},z={key:0,class:"ait-p-4"};function j(e,t,i,r,o,s){const l=g("svg-logo"),n=g("single-response"),f=g("modal");return p(),I(f,{title:e.__("Upload PDF"),id:"ait-pdf-upload-modal",className:"ait-items-center",onDrop:d(e.handleDrop,["prevent"]),onDragover:d(e.dragOver,["prevent"]),onDragenter:d(e.dragEnter,["prevent"]),onDragleave:d(e.dragLeave,["prevent"])},{default:x((()=>[a("div",S,[a("p",N,c(e.__("Upload a PDF File to easily get intelligent summaries and answers for your documents.")),1),a("input",{type:"file",id:"fileInputPDF",onChange:t[0]||(t[0]=(...a)=>e.uploadPDF&&e.uploadPDF(...a)),disabled:e.pdfUploadIsProcessing,accept:"application/pdf",style:{display:"none"}},null,40,$),a("label",T,[a("div",B,[P(l,{className:"aait-w-16 ait-h-16 ait-opacity-60",name:"pdf_icon"}),a("div",q,[a("span",G,c(e.__("Supported file type is PDF")),1)]),a("span",{class:E(["ait-block ait-mt-2",e.pdfUploadDragActive?"ait-opacity-100":"ait-opacity-60"])},c(e.pdfUploadDragActive?e.__("Drop your PDF here"):e.__("Drag your PDF here or click to upload")),3)])]),e.pdfUploadIsProcessing?(p(),m("div",H,O)):h("",!0),a("div",V,[e.pdfUploadErrorMessage?(p(),m("p",W,c(e.pdfUploadErrorMessage),1)):h("",!0)])]),this.pdfUploadPromptId?(p(),m("div",z,[P(n,{class:"ait-p-2 ait-rounded-lg ait-bg-neutral-100 dark:ait-bg-neutral-900 dark:ait-text-gray-200",id:"aitopia-pdf-summary",custom_key:this.pdfUploadPromptId,onContinueChatClick:this.closeModel},null,8,["custom_key","onContinueChatClick"])])):h("",!0)])),_:1},8,["title","onDrop","onDragover","onDragenter","onDragleave"])}const ie=k(M,[["render",j]]);export{ie as default};